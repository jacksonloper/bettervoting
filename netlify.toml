# Netlify configuration for the BetterVoting frontend
# This configuration deploys the frontend and points it to the production backend at https://bettervoting.com

[build]
  # Base directory for the build
  base = "packages/frontend"
  # Install dependencies and build the frontend
  command = "npm install && npm run build"
  # Directory containing the built files to publish
  publish = "build"

[build.environment]
  # Point the frontend to the production backend
  REACT_APP_BACKEND_URL = "https://bettervoting.com"
  REACT_APP_KEYCLOAK_URL = "https://keycloak.prod.equal.vote/realms/Prod/protocol/openid-connect"

# Proxy API requests to the production backend
[[redirects]]
  from = "/API/*"
  to = "https://bettervoting.com/API/:splat"
  status = 200
  force = true

# SPA routing: redirect all other paths to index.html for client-side routing
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
